{"metadata":{"name":"TwitterAnalysis","user_save_timestamp":"1969-12-31T19:00:00.000Z","auto_save_timestamp":"1969-12-31T19:00:00.000Z","language_info":{"name":"scala","file_extension":"scala","codemirror_mode":"text/x-scala"},"trusted":true,"customLocalRepo":null,"customRepos":null,"customDeps":null,"customImports":null,"customArgs":null,"customSparkConf":null},"cells":[{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"4EEB772D945A43AD935DB204F4C53009"},"cell_type":"code","source":"import org.apache.spark.graphx.GraphLoader\nimport scala.util.MurmurHash\nimport org.apache.spark.graphx.Graph\nimport org.apache.spark.rdd.RDD\nimport org.apache.spark.graphx.VertexId\nimport org.apache.spark.SparkContext._\n\nval input = sc.textFile(\"C:/Python27_new/files/relationsNew.csv\")\ninput.count()\nval edgesRDD: RDD[(VertexId, VertexId)] = input.map(line => line.split(\",\")).map(line => (line(0).toLong, line(1).toLong))\nval graph = Graph.fromEdgeTuples(edgesRDD, 1)","outputs":[{"name":"stdout","output_type":"stream","text":"import org.apache.spark.graphx.GraphLoader\r\nimport scala.util.MurmurHash\r\nimport org.apache.spark.graphx.Graph\r\nimport org.apache.spark.rdd.RDD\r\nimport org.apache.spark.graphx.VertexId\r\nimport org.apache.spark.SparkContext._\r\ninput: org.apache.spark.rdd.RDD[String] = C:/Python27_new/files/relationsNew.csv MapPartitionsRDD[1] at textFile at <console>:63\r\nedgesRDD: org.apache.spark.rdd.RDD[(org.apache.spark.graphx.VertexId, org.apache.spark.graphx.VertexId)] = MapPartitionsRDD[3] at map at <console>:65\r\ngraph: org.apache.spark.graphx.Graph[Int,Int] = org.apache.spark.graphx.impl.GraphImpl@4bbfc32f\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":1,"time":"Took: 7 seconds 448 milliseconds, at 2017-3-23 21:1"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"264A89B639684C8C9787307F595070FC"},"cell_type":"code","source":"val sqlContext = new org.apache.spark.sql.SQLContext(sc)","outputs":[{"name":"stdout","output_type":"stream","text":"sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@7ba634e2\n"},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":2,"time":"Took: 3 seconds 275 milliseconds, at 2017-3-23 21:1"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"EED0D6ADE83D4FBF94CC2AE77B5E7AF5"},"cell_type":"code","source":"//PAGE-RANK HISTOGRAM\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\n\nval ranks = graph.pageRank(0.0001).vertices\nval pr = ranks.map(_._2)\n\nval r = new DoubleRDDFunctions(pr)\nval hist = r.histogram(50)\nval startValues = hist._1\nval counts = hist._2\n\nimport sqlContext.implicits._\nval zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\n\nval pghistDf = sqlContext.createDataFrame(rowRDD)\n\npghistDf.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+-------------------+-----+\n|         startPoint|count|\n+-------------------+-----+\n|               0.15|15041|\n|0.15093973091644655| 5818|\n| 0.1518794618328931| 1326|\n|0.15281919274933967|  498|\n| 0.1537589236657862|  299|\n|0.15469865458223275|  179|\n| 0.1556383854986793|  105|\n|0.15657811641512587|   95|\n|0.15751784733157242|   30|\n|0.15845757824801898|   52|\n|0.15939730916446554|   27|\n| 0.1603370400809121|   18|\n|0.16127677099735863|   19|\n|0.16221650191380518|   17|\n|0.16315623283025174|   14|\n| 0.1640959637466983|    9|\n|0.16503569466314486|   10|\n| 0.1659754255795914|    5|\n|0.16691515649603794|    5|\n| 0.1678548874124845|    2|\n+-------------------+-----+\nonly showing top 20 rows\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\nranks: org.apache.spark.graphx.VertexRDD[Double] = VertexRDDImpl[734] at RDD at VertexRDD.scala:59\npr: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[737] at map at <console>:44\nr: org.apache.spark.rdd.DoubleRDDFunctions = org.apache.spark.rdd.DoubleRDDFunctions@51a36757\nhist: Pair[Array[Double],Array[Long]] = (Array(0.15, 0.15093973091644655, 0.1518794618328931, 0.15281919274933967, 0.1537589236657862, 0.15469865458223275, 0.1556383854986793, 0.15657811641512587, 0.15751784733157242, 0.15845757824801898, 0.15939730916446554, 0.1603370400809121, 0.16127677099735863, 0.16221650191380518, 0.16315623283025174, 0.1640959637466983, 0.16503569466314486, 0.1659754255795914, 0.16691515649603794, 0.1678548874124845, 0.16879461832893106, 0.1..."},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":19,"time":"Took: 6 seconds 774 milliseconds, at 2017-3-23 21:13"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"presentation":{"tabs_state":"{\n  \"tab_id\": \"#tab352629806-3\"\n}","pivot_chart_state":"{\n  \"hiddenAttributes\": [],\n  \"menuLimit\": 200,\n  \"cols\": [],\n  \"rows\": [],\n  \"vals\": [],\n  \"exclusions\": {},\n  \"inclusions\": {},\n  \"unusedAttrsVertical\": 85,\n  \"autoSortUnusedAttrs\": false,\n  \"inclusionsInfo\": {},\n  \"aggregatorName\": \"Count\",\n  \"rendererName\": \"Table\"\n}"},"id":"2E3F9E5676D446B38815AC846E733CB4"},"cell_type":"code","source":"pghistDf.collect()","outputs":[{"name":"stdout","output_type":"stream","text":"res35: Array[org.apache.spark.sql.Row] = Array([0.15,15041], [0.15093973091644655,5818], [0.1518794618328931,1326], [0.15281919274933967,498], [0.1537589236657862,299], [0.15469865458223275,179], [0.1556383854986793,105], [0.15657811641512587,95], [0.15751784733157242,30], [0.15845757824801898,52], [0.15939730916446554,27], [0.1603370400809121,18], [0.16127677099735863,19], [0.16221650191380518,17], [0.16315623283025174,14], [0.1640959637466983,9], [0.16503569466314486,10], [0.1659754255795914,5], [0.16691515649603794,5], [0.1678548874124845,2], [0.16879461832893106,2], [0.1697343492453776,3], [0.17067408016182417,6], [0.17161381107827073,1], [0.17255354199471729,0], [0.17349327291116384,1], [0.17443300382761037,0], [0.17537273474405693,0], [0.1763124656605035,0], [0.17725219657695004,0..."},{"metadata":{},"data":{"text/html":"<div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anondfe614fb6a6b8f93995b0348d6302828&quot;,&quot;dataInit&quot;:[],&quot;genId&quot;:&quot;352629806&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tabs'], \n      function(playground, _magictabs) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictabs,\n    \"o\": {}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <div>\n        <ul class=\"nav nav-tabs\" id=\"ul352629806\"><li>\n              <a href=\"#tab352629806-0\"><i class=\"fa fa-table\"/></a>\n            </li><li>\n              <a href=\"#tab352629806-1\"><i class=\"fa fa-dot-circle-o\"/></a>\n            </li><li>\n              <a href=\"#tab352629806-2\"><i class=\"fa fa-line-chart\"/></a>\n            </li><li>\n              <a href=\"#tab352629806-3\"><i class=\"fa fa-bar-chart\"/></a>\n            </li><li>\n              <a href=\"#tab352629806-4\"><i class=\"fa fa-cubes\"/></a>\n            </li></ul>\n\n        <div class=\"tab-content\" id=\"tab352629806\"><div class=\"tab-pane\" id=\"tab352629806-0\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonf42d227d4d14eab93667d67e9a5a1a9f&quot;,&quot;dataInit&quot;:[{&quot;startPoint&quot;:0.15,&quot;count&quot;:15041},{&quot;startPoint&quot;:0.15093973091644655,&quot;count&quot;:5818},{&quot;startPoint&quot;:0.1518794618328931,&quot;count&quot;:1326},{&quot;startPoint&quot;:0.15281919274933967,&quot;count&quot;:498},{&quot;startPoint&quot;:0.1537589236657862,&quot;count&quot;:299},{&quot;startPoint&quot;:0.15469865458223275,&quot;count&quot;:179},{&quot;startPoint&quot;:0.1556383854986793,&quot;count&quot;:105},{&quot;startPoint&quot;:0.15657811641512587,&quot;count&quot;:95},{&quot;startPoint&quot;:0.15751784733157242,&quot;count&quot;:30},{&quot;startPoint&quot;:0.15845757824801898,&quot;count&quot;:52},{&quot;startPoint&quot;:0.15939730916446554,&quot;count&quot;:27},{&quot;startPoint&quot;:0.1603370400809121,&quot;count&quot;:18},{&quot;startPoint&quot;:0.16127677099735863,&quot;count&quot;:19},{&quot;startPoint&quot;:0.16221650191380518,&quot;count&quot;:17},{&quot;startPoint&quot;:0.16315623283025174,&quot;count&quot;:14},{&quot;startPoint&quot;:0.1640959637466983,&quot;count&quot;:9},{&quot;startPoint&quot;:0.16503569466314486,&quot;count&quot;:10},{&quot;startPoint&quot;:0.1659754255795914,&quot;count&quot;:5},{&quot;startPoint&quot;:0.16691515649603794,&quot;count&quot;:5},{&quot;startPoint&quot;:0.1678548874124845,&quot;count&quot;:2},{&quot;startPoint&quot;:0.16879461832893106,&quot;count&quot;:2},{&quot;startPoint&quot;:0.1697343492453776,&quot;count&quot;:3},{&quot;startPoint&quot;:0.17067408016182417,&quot;count&quot;:6},{&quot;startPoint&quot;:0.17161381107827073,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17255354199471729,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17349327291116384,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17443300382761037,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17537273474405693,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1763124656605035,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17725219657695004,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1781919274933966,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17913165840984316,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1800713893262897,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18101112024273625,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1819508511591828,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18289058207562936,&quot;count&quot;:1},{&quot;startPoint&quot;:0.18383031299207592,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18477004390852247,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18570977482496903,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1866495057414156,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18758923665786215,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18852896757430868,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18946869849075523,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1904084294072018,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19134816032364835,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1922878912400949,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19322762215654143,&quot;count&quot;:0},{&quot;startPoint&quot;:0.194167353072988,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19510708398943455,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1960468149058811,&quot;count&quot;:1}],&quot;genId&quot;:&quot;884651240&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/tableChart'], \n      function(playground, _magictableChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magictableChart,\n    \"o\": {\"headers\":[\"startPoint\",\"count\"],\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon0eb28e20892254463244c98380afb44e&quot;,&quot;initialValue&quot;:&quot;50&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon3bb509b500f4d8816befc2114dfea53c&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab352629806-1\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon8f664d68f295a038926c0a352fdfeb5a&quot;,&quot;dataInit&quot;:[{&quot;startPoint&quot;:0.15,&quot;count&quot;:15041},{&quot;startPoint&quot;:0.15093973091644655,&quot;count&quot;:5818},{&quot;startPoint&quot;:0.1518794618328931,&quot;count&quot;:1326},{&quot;startPoint&quot;:0.15281919274933967,&quot;count&quot;:498},{&quot;startPoint&quot;:0.1537589236657862,&quot;count&quot;:299},{&quot;startPoint&quot;:0.15469865458223275,&quot;count&quot;:179},{&quot;startPoint&quot;:0.1556383854986793,&quot;count&quot;:105},{&quot;startPoint&quot;:0.15657811641512587,&quot;count&quot;:95},{&quot;startPoint&quot;:0.15751784733157242,&quot;count&quot;:30},{&quot;startPoint&quot;:0.15845757824801898,&quot;count&quot;:52},{&quot;startPoint&quot;:0.15939730916446554,&quot;count&quot;:27},{&quot;startPoint&quot;:0.1603370400809121,&quot;count&quot;:18},{&quot;startPoint&quot;:0.16127677099735863,&quot;count&quot;:19},{&quot;startPoint&quot;:0.16221650191380518,&quot;count&quot;:17},{&quot;startPoint&quot;:0.16315623283025174,&quot;count&quot;:14},{&quot;startPoint&quot;:0.1640959637466983,&quot;count&quot;:9},{&quot;startPoint&quot;:0.16503569466314486,&quot;count&quot;:10},{&quot;startPoint&quot;:0.1659754255795914,&quot;count&quot;:5},{&quot;startPoint&quot;:0.16691515649603794,&quot;count&quot;:5},{&quot;startPoint&quot;:0.1678548874124845,&quot;count&quot;:2},{&quot;startPoint&quot;:0.16879461832893106,&quot;count&quot;:2},{&quot;startPoint&quot;:0.1697343492453776,&quot;count&quot;:3},{&quot;startPoint&quot;:0.17067408016182417,&quot;count&quot;:6},{&quot;startPoint&quot;:0.17161381107827073,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17255354199471729,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17349327291116384,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17443300382761037,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17537273474405693,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1763124656605035,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17725219657695004,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1781919274933966,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17913165840984316,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1800713893262897,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18101112024273625,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1819508511591828,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18289058207562936,&quot;count&quot;:1},{&quot;startPoint&quot;:0.18383031299207592,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18477004390852247,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18570977482496903,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1866495057414156,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18758923665786215,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18852896757430868,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18946869849075523,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1904084294072018,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19134816032364835,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1922878912400949,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19322762215654143,&quot;count&quot;:0},{&quot;startPoint&quot;:0.194167353072988,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19510708398943455,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1960468149058811,&quot;count&quot;:1}],&quot;genId&quot;:&quot;619017245&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/scatterChart'], \n      function(playground, _magicscatterChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicscatterChart,\n    \"o\": {\"x\":\"startPoint\",\"y\":\"count\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonff6db396441adbbe58e31bf23181c016&quot;,&quot;initialValue&quot;:&quot;50&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon6a97a9e0161a5dc1a0a35347090d8e4c&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab352629806-2\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anonc3d65409ae903ffea1c6bb5a2b4a1f10&quot;,&quot;dataInit&quot;:[{&quot;startPoint&quot;:0.15,&quot;count&quot;:15041},{&quot;startPoint&quot;:0.15093973091644655,&quot;count&quot;:5818},{&quot;startPoint&quot;:0.1518794618328931,&quot;count&quot;:1326},{&quot;startPoint&quot;:0.15281919274933967,&quot;count&quot;:498},{&quot;startPoint&quot;:0.1537589236657862,&quot;count&quot;:299},{&quot;startPoint&quot;:0.15469865458223275,&quot;count&quot;:179},{&quot;startPoint&quot;:0.1556383854986793,&quot;count&quot;:105},{&quot;startPoint&quot;:0.15657811641512587,&quot;count&quot;:95},{&quot;startPoint&quot;:0.15751784733157242,&quot;count&quot;:30},{&quot;startPoint&quot;:0.15845757824801898,&quot;count&quot;:52},{&quot;startPoint&quot;:0.15939730916446554,&quot;count&quot;:27},{&quot;startPoint&quot;:0.1603370400809121,&quot;count&quot;:18},{&quot;startPoint&quot;:0.16127677099735863,&quot;count&quot;:19},{&quot;startPoint&quot;:0.16221650191380518,&quot;count&quot;:17},{&quot;startPoint&quot;:0.16315623283025174,&quot;count&quot;:14},{&quot;startPoint&quot;:0.1640959637466983,&quot;count&quot;:9},{&quot;startPoint&quot;:0.16503569466314486,&quot;count&quot;:10},{&quot;startPoint&quot;:0.1659754255795914,&quot;count&quot;:5},{&quot;startPoint&quot;:0.16691515649603794,&quot;count&quot;:5},{&quot;startPoint&quot;:0.1678548874124845,&quot;count&quot;:2},{&quot;startPoint&quot;:0.16879461832893106,&quot;count&quot;:2},{&quot;startPoint&quot;:0.1697343492453776,&quot;count&quot;:3},{&quot;startPoint&quot;:0.17067408016182417,&quot;count&quot;:6},{&quot;startPoint&quot;:0.17161381107827073,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17255354199471729,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17349327291116384,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17443300382761037,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17537273474405693,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1763124656605035,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17725219657695004,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1781919274933966,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17913165840984316,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1800713893262897,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18101112024273625,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1819508511591828,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18289058207562936,&quot;count&quot;:1},{&quot;startPoint&quot;:0.18383031299207592,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18477004390852247,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18570977482496903,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1866495057414156,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18758923665786215,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18852896757430868,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18946869849075523,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1904084294072018,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19134816032364835,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1922878912400949,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19322762215654143,&quot;count&quot;:0},{&quot;startPoint&quot;:0.194167353072988,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19510708398943455,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1960468149058811,&quot;count&quot;:1}],&quot;genId&quot;:&quot;1301211592&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/lineChart'], \n      function(playground, _magiclineChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magiclineChart,\n    \"o\": {\"x\":\"startPoint\",\"y\":\"count\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon1e32e80cfdc374de7423caae58f517cf&quot;,&quot;initialValue&quot;:&quot;50&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anona7a7d8a76d9c0a148031e8f19b846efa&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab352629806-3\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon4e1f180b34d8b01c4db28e1cb14977d2&quot;,&quot;dataInit&quot;:[{&quot;startPoint&quot;:0.15,&quot;count&quot;:15041},{&quot;startPoint&quot;:0.15093973091644655,&quot;count&quot;:5818},{&quot;startPoint&quot;:0.1518794618328931,&quot;count&quot;:1326},{&quot;startPoint&quot;:0.15281919274933967,&quot;count&quot;:498},{&quot;startPoint&quot;:0.1537589236657862,&quot;count&quot;:299},{&quot;startPoint&quot;:0.15469865458223275,&quot;count&quot;:179},{&quot;startPoint&quot;:0.1556383854986793,&quot;count&quot;:105},{&quot;startPoint&quot;:0.15657811641512587,&quot;count&quot;:95},{&quot;startPoint&quot;:0.15751784733157242,&quot;count&quot;:30},{&quot;startPoint&quot;:0.15845757824801898,&quot;count&quot;:52},{&quot;startPoint&quot;:0.15939730916446554,&quot;count&quot;:27},{&quot;startPoint&quot;:0.1603370400809121,&quot;count&quot;:18},{&quot;startPoint&quot;:0.16127677099735863,&quot;count&quot;:19},{&quot;startPoint&quot;:0.16221650191380518,&quot;count&quot;:17},{&quot;startPoint&quot;:0.16315623283025174,&quot;count&quot;:14},{&quot;startPoint&quot;:0.1640959637466983,&quot;count&quot;:9},{&quot;startPoint&quot;:0.16503569466314486,&quot;count&quot;:10},{&quot;startPoint&quot;:0.1659754255795914,&quot;count&quot;:5},{&quot;startPoint&quot;:0.16691515649603794,&quot;count&quot;:5},{&quot;startPoint&quot;:0.1678548874124845,&quot;count&quot;:2},{&quot;startPoint&quot;:0.16879461832893106,&quot;count&quot;:2},{&quot;startPoint&quot;:0.1697343492453776,&quot;count&quot;:3},{&quot;startPoint&quot;:0.17067408016182417,&quot;count&quot;:6},{&quot;startPoint&quot;:0.17161381107827073,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17255354199471729,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17349327291116384,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17443300382761037,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17537273474405693,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1763124656605035,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17725219657695004,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1781919274933966,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17913165840984316,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1800713893262897,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18101112024273625,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1819508511591828,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18289058207562936,&quot;count&quot;:1},{&quot;startPoint&quot;:0.18383031299207592,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18477004390852247,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18570977482496903,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1866495057414156,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18758923665786215,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18852896757430868,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18946869849075523,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1904084294072018,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19134816032364835,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1922878912400949,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19322762215654143,&quot;count&quot;:0},{&quot;startPoint&quot;:0.194167353072988,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19510708398943455,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1960468149058811,&quot;count&quot;:1}],&quot;genId&quot;:&quot;1426076177&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/barChart'], \n      function(playground, _magicbarChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicbarChart,\n    \"o\": {\"x\":\"startPoint\",\"y\":\"count\",\"width\":600,\"height\":400}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anonc55d0230ff00d7cdc2ae3b8ead5a24ca&quot;,&quot;initialValue&quot;:&quot;50&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anoncb73712287d8a15bf5314edf851613ab&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div><div class=\"tab-pane\" id=\"tab352629806-4\">\n            <div>\n      <script data-this=\"{&quot;dataId&quot;:&quot;anon7922a6f813b854679b49ee26d95be672&quot;,&quot;dataInit&quot;:[{&quot;startPoint&quot;:0.15,&quot;count&quot;:15041},{&quot;startPoint&quot;:0.15093973091644655,&quot;count&quot;:5818},{&quot;startPoint&quot;:0.1518794618328931,&quot;count&quot;:1326},{&quot;startPoint&quot;:0.15281919274933967,&quot;count&quot;:498},{&quot;startPoint&quot;:0.1537589236657862,&quot;count&quot;:299},{&quot;startPoint&quot;:0.15469865458223275,&quot;count&quot;:179},{&quot;startPoint&quot;:0.1556383854986793,&quot;count&quot;:105},{&quot;startPoint&quot;:0.15657811641512587,&quot;count&quot;:95},{&quot;startPoint&quot;:0.15751784733157242,&quot;count&quot;:30},{&quot;startPoint&quot;:0.15845757824801898,&quot;count&quot;:52},{&quot;startPoint&quot;:0.15939730916446554,&quot;count&quot;:27},{&quot;startPoint&quot;:0.1603370400809121,&quot;count&quot;:18},{&quot;startPoint&quot;:0.16127677099735863,&quot;count&quot;:19},{&quot;startPoint&quot;:0.16221650191380518,&quot;count&quot;:17},{&quot;startPoint&quot;:0.16315623283025174,&quot;count&quot;:14},{&quot;startPoint&quot;:0.1640959637466983,&quot;count&quot;:9},{&quot;startPoint&quot;:0.16503569466314486,&quot;count&quot;:10},{&quot;startPoint&quot;:0.1659754255795914,&quot;count&quot;:5},{&quot;startPoint&quot;:0.16691515649603794,&quot;count&quot;:5},{&quot;startPoint&quot;:0.1678548874124845,&quot;count&quot;:2},{&quot;startPoint&quot;:0.16879461832893106,&quot;count&quot;:2},{&quot;startPoint&quot;:0.1697343492453776,&quot;count&quot;:3},{&quot;startPoint&quot;:0.17067408016182417,&quot;count&quot;:6},{&quot;startPoint&quot;:0.17161381107827073,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17255354199471729,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17349327291116384,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17443300382761037,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17537273474405693,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1763124656605035,&quot;count&quot;:0},{&quot;startPoint&quot;:0.17725219657695004,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1781919274933966,&quot;count&quot;:1},{&quot;startPoint&quot;:0.17913165840984316,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1800713893262897,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18101112024273625,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1819508511591828,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18289058207562936,&quot;count&quot;:1},{&quot;startPoint&quot;:0.18383031299207592,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18477004390852247,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18570977482496903,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1866495057414156,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18758923665786215,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18852896757430868,&quot;count&quot;:0},{&quot;startPoint&quot;:0.18946869849075523,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1904084294072018,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19134816032364835,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1922878912400949,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19322762215654143,&quot;count&quot;:0},{&quot;startPoint&quot;:0.194167353072988,&quot;count&quot;:0},{&quot;startPoint&quot;:0.19510708398943455,&quot;count&quot;:0},{&quot;startPoint&quot;:0.1960468149058811,&quot;count&quot;:1}],&quot;genId&quot;:&quot;1584988877&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/req(['../javascripts/notebook/playground','../javascripts/notebook/magic/pivotChart'], \n      function(playground, _magicpivotChart) {\n        // data ==> data-this (in observable.js's scopedEval) ==> this in JS => { dataId, dataInit, ... }\n        // this ==> scope (in observable.js's scopedEval) ==> this.parentElement ==> div.container below (toHtml)\n\n        playground.call(data,\n                        this\n                        ,\n                        {\n    \"f\": _magicpivotChart,\n    \"o\": {\"width\":600,\"height\":400,\"derivedAttributes\":{},\"extraOptions\":{}}\n  }\n  \n                        \n                        \n                      );\n      }\n    );/*]]>*/</script>\n    <div>\n      <span class=\"chart-total-item-count\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anone83d80d1a3382f2d6e709b33429db5b2&quot;,&quot;initialValue&quot;:&quot;50&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p> entries total</span>\n      <span class=\"chart-sampling-warning\"><p data-bind=\"text: value\"><script data-this=\"{&quot;valueId&quot;:&quot;anon00c62774f215ed31ba134b0eb045be6c&quot;,&quot;initialValue&quot;:&quot;&quot;}\" type=\"text/x-scoped-javascript\">/*<![CDATA[*/\nreq(\n['observable', 'knockout'],\nfunction (O, ko) {\n  ko.applyBindings({\n      value: O.makeObservable(valueId, initialValue)\n    },\n    this\n  );\n});\n        /*]]>*/</script></p></span>\n      <div>\n      </div>\n    </div></div>\n            </div></div>\n      </div>\n    </div></div>"},"output_type":"execute_result","execution_count":20,"time":"Took: 2 seconds 990 milliseconds, at 2017-3-23 21:13"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"E809343BCD324D4E809574FF8811EDE1"},"cell_type":"code","source":"//IN-DEGREE HISTOGRAM\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\nval inDegTemp = graph.inDegrees\nval inDegs = inDegTemp.map(_._2).map(v=>v.toDouble)\nval r = new DoubleRDDFunctions(inDegs)\nval hist = r.histogram(20)\nval startValues = hist._1\nval counts = hist._2\n\nimport sqlContext.implicits._\nval zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\n//val histDf = rowRDD.toDF\nval inhistDf = sqlContext.createDataFrame(rowRDD)\n\ninhistDf.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+----------+-----+\n|startPoint|count|\n+----------+-----+\n|       1.0|22136|\n|       2.5|  649|\n|       4.0|  426|\n|       5.5|   88|\n|       7.0|   90|\n|       8.5|   27|\n|      10.0|   29|\n|      11.5|    6|\n|      13.0|   11|\n|      14.5|    8|\n|      16.0|    8|\n|      17.5|    1|\n|      19.0|    3|\n|      20.5|    0|\n|      22.0|    3|\n|      23.5|    0|\n|      25.0|    1|\n|      26.5|    0|\n|      28.0|    0|\n|      29.5|    2|\n+----------+-----+\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\ninDegTemp: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[110] at RDD at VertexRDD.scala:59\ninDegs: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[112] at map at <console>:42\nr: org.apache.spark.rdd.DoubleRDDFunctions = org.apache.spark.rdd.DoubleRDDFunctions@4a38a733\nhist: Pair[Array[Double],Array[Long]] = (Array(1.0, 2.5, 4.0, 5.5, 7.0, 8.5, 10.0, 11.5, 13.0, 14.5, 16.0, 17.5, 19.0, 20.5, 22.0, 23.5, 25.0, 26.5, 28.0, 29.5, 31.0),Array(22136, 649, 426, 88, 90, 27, 29, 6, 11, 8, 8, 1, 3, 0, 3, 0, 1, 0, 0, 2))\nstartValues: Array[Double] = Array(1.0, 2.5, 4.0, 5.5, 7.0, 8.5, 10.0, 11.5, 13.0, 14.5, 16.0, 17.5, 19.0, 20.5, 22.0, 23.5, 25.0, 26.5, 28.0, 29.5, 31.0)\ncounts: Array[Long] = Array(22136, 649, 426, 88, 90, 27, 29,..."},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":4,"time":"Took: 5 seconds 907 milliseconds, at 2017-3-23 21:2"}]},{"metadata":{"trusted":true,"input_collapsed":false,"collapsed":false,"id":"7B80CF4567494C529BDBBBDCDCC3EAE7"},"cell_type":"code","source":"//OUT-DEGREE HISTOGRAM\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\nval outDegTemp = graph.outDegrees\nval outDegs = outDegTemp.map(_._2).map(v=>v.toDouble)\nval r = new DoubleRDDFunctions(outDegs)\nval hist = r.histogram(20)\nval startValues = hist._1\nval counts = hist._2\n\nimport sqlContext.implicits._\nval zippedValues = startValues.zip(counts)\ncase class HistRow(startPoint:Double,count:Long)\nval rowRDD = zippedValues.map( value => HistRow(value._1,value._2))\n//val histDf = rowRDD.toDF\nval outhistDf = sqlContext.createDataFrame(rowRDD)\n\nouthistDf.show()","outputs":[{"name":"stdout","output_type":"stream","text":"+----------+-----+\n|startPoint|count|\n+----------+-----+\n|       6.0|    6|\n|     18.05|   10|\n|      30.1|    8|\n|     42.15|    3|\n|      54.2|   12|\n|     66.25|   12|\n|      78.3|    9|\n|     90.35|   12|\n|     102.4|    7|\n|    114.45|   11|\n|     126.5|   16|\n|    138.55|   15|\n|     150.6|    7|\n|    162.65|   14|\n|     174.7|   12|\n|    186.75|   11|\n|     198.8|   14|\n|    210.85|   18|\n|     222.9|   14|\n|    234.95|    8|\n+----------+-----+\n\nimport org.apache.spark.rdd.DoubleRDDFunctions\noutDegTemp: org.apache.spark.graphx.VertexRDD[Int] = VertexRDDImpl[17] at RDD at VertexRDD.scala:59\noutDegs: org.apache.spark.rdd.RDD[Double] = MapPartitionsRDD[116] at map at <console>:42\nr: org.apache.spark.rdd.DoubleRDDFunctions = org.apache.spark.rdd.DoubleRDDFunctions@6de8374c\nhist: Pair[Array[Double],Array[Long]] = (Array(6.0, 18.05, 30.1, 42.15, 54.2, 66.25, 78.3, 90.35, 102.4, 114.45, 126.5, 138.55, 150.6, 162.65, 174.7, 186.75, 198.8, 210.85, 222.9, 234.95, 247.0),Array(6, 10, 8, 3, 12, 12, 9, 12, 7, 11, 16, 15, 7, 14, 12, 11, 14, 18, 14, 8))\nstartValues: Array[Double] = Array(6.0, 18.05, 30.1, 42.15, 54.2, 66.25, 78.3, 90.35, 102.4, 114.45, 126.5, 138.55, 150.6, 162.65, 174.7, 186.75, 198.8, 210.85, 222.9, 234.95, 247.0)\ncou..."},{"metadata":{},"data":{"text/html":""},"output_type":"execute_result","execution_count":5,"time":"Took: 5 seconds 541 milliseconds, at 2017-3-23 21:2"}]}],"nbformat":4}